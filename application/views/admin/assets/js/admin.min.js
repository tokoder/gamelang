(function($,window,document,undefined){"use strict";cg.languages=cg.languages||{};cg.packages=cg.packages||{};cg.themes=cg.themes||{};if(typeof bootbox!=="undefined"){bootbox.setDefaults({backdrop:false,closeButton:false,locale:cg.config.lang.code,size:"small"});}
cg.ui={confirm:function(message,trueCallback,falseCallback){if(typeof bootbox!=="undefined"){bootbox.confirm({message:message,buttons:{confirm:{className:"btn btn-primary btn-sm"},cancel:{className:"btn btn-default btn-sm"}},callback:function(result){bootbox.hideAll();if(result===true&&typeof trueCallback==="function"){trueCallback(true);}else if(typeof falseCallback==="function"){falseCallback(true);}}});}else if(confirm(message)&&typeof trueCallback==="function"){trueCallback(true);}else if(typeof falseCallback==="function"){falseCallback(true);}},alert:function(message,type){if(!message.length){return false;}
type=type||'info';if(type==="error"){type="danger";}
if(typeof toastr!=="undefined"){switch(type){case"success":toastr.success(message);break;case"error":case"danger":toastr.error(message);break;case"warning":toastr.warning(message);break;case"info":default:toastr.info(message);break;}
return;}
if(typeof Handlebars==="object"){var oldAlert=$("#alert"),alertSource=document.getElementById("alert-template").innerHTML,alertTemplate=Handlebars.compile(alertSource);var alertCompiled=alertTemplate({message:message,type:type});if(oldAlert.length){oldAlert.fadeOut(function(){$(this).remove();$(alertCompiled).prependTo("#wrapper > .container");});}else{$(alertCompiled).prependTo("#wrapper > .container");}
return;}
alert(message.replace(/(<([^>]+)>)/ig,""));},reload:function(el,navbar=false,callback){el=el||"#wrapper";if(navbar===true){$("#navbar-admin").load(cg.config.currentURL+" #navbar-admin > *");}
if(el.length&&typeof callback==="function"){$(el).load(cg.config.currentURL+" "+el+" > *",callback);}else if(el.length){$(el).load(cg.config.currentURL+" "+el+" > *");}},inViewport:function(el){var that=el.getBoundingClientRect();return(that.bottom>=0&&that.right>=0&&that.top<=(window.innerHeight||document.documentElement.clientHeight)&&that.left<=(window.innerWidth||document.documentElement.clientWidth));},addListener:function(event,callback){if(window.addEventListener){window.addEventListener(event,callback);}else{window.attachEvent("on"+event,callback);}},lazyLoad:function(){var lazyImages=$("img[data-src]");for(var i=0;i<lazyImages.length;i++){var img=lazyImages[i];if(cg.ui.inViewport(img)){img.src=img.getAttribute("data-src");img.onload=function(){this.removeAttribute("data-src");};}}},initSummerNote:function(ids){for(var i=0;i<ids.length;i++){!function(o){"use strict";var e=function(){this.$body=o("body")};e.prototype.init=function(){o(ids[i]).summernote({placeholder:"",height:200,callbacks:{onInit:function(e){o(e.editor).find(".custom-control-description").addClass("custom-control-label").parent().removeAttr("for")},},});},o.Summernote=new e,o.Summernote.Constructor=e}(window.jQuery),function(o){"use strict";o.Summernote.init()}(window.jQuery);}}};cg.ajax={requests:[],requesting:false,context:undefined,request:function(url,params){params=params||{};var context=params.context||this,type=params.type||"GET";params=$.extend({url:url,method:type,type:type,async:true,cache:false,dataType:"json",success:function(data,textStatus,jqXHR){cg.ajax._response(data);},error:function(jqXHR,textStatus,errorThrown){var response=jqXHR.responseJSON||undefined;if(typeof response!=="undefined"&&response.message!=="undefined"&&response.message.length){cg.ui.alert(response.message,"error");}}},params);this.requests.push(params);this._execute();},stop:function(){this.requests=[];},_execute:function(){if(this.requests.length==0){return;}
if(this.requesting==true){return;}
var request=this.requests.splice(0,1)[0],complete=request.complete;var self=this;if(request._execute){request._execute(request);}
request.complete=function(){if(complete){complete.apply(this,arguments);}
self.requesting=false;self._execute();}
this.requesting=true;$.ajax(request);},_response:function(data){var data=data||{},context=this;cg.ajax.context=context;if(typeof data.message!=="undefined"&&data.message.length){cg.ui.alert(data.message,"success");}
if(typeof data.scripts==="undefined"){return;}
var _scripts=data.scripts.length;for(var i=0;i<_scripts;i++){try{(new Function(data.scripts[i])).call(context);}catch(e){console.log(e);}}}};cg.ui.addListener("load",cg.ui.lazyLoad);cg.ui.addListener("scroll",cg.ui.lazyLoad);$(document).ready(function(){if(typeof toastr!=="undefined"){toastr.options={"closeButton":true,"positionClass":"toast-top-center","hideDuration":"300","timeOut":"2500","showEasing":"swing","hideEasing":"linear","showMethod":"fadeIn","hideMethod":"fadeOut"};if(cg.config.lang.direction==='rtl'){toastr.options.rtl=true;}}
$(document).on("change",":checkbox[name=check-all]",function(){var that=$(this);that.closest("table").find("tbody :checkbox").prop("checked",this.checked).closest("tr").toggleClass("selected",this.checked);});$(document).on("change",":checkbox.check-this",function(){$(this).parents("tr").toggleClass("selected",this.checked);});if(typeof $.fn.tooltip!=="undefined"){$("body").tooltip({selector:"[data-toggle=tooltip], [rel=tooltip]"});}
if(typeof $.fn.popover!=="undefined"){$("body").tooltip({selector:"[data-toggle=popover], [rel=popover]"});}
$(document).on("submit","form",function(e){var $form=$(this);$form.find("[type=submit]").prop("disabled",true).addClass("disabled");$form.submit(function(){return false;});return true;});if(typeof $.fn.garlic!=="undefined"){$("[rel=persist]").garlic();}
$(document).on("click","a[rel]",function(e){var $this=$(this),rel=$this.attr("rel"),href=$this.attr("href");if(typeof href==="undefined"||!href.length){e.preventDefault();return false;}
if(!rel.length||rel!=="async"||rel!=="async-post"){return;}
e.preventDefault();var type=(rel==="async")?"GET":"POST";cg.ajax.request(href,{el:this,type:type,beforeSend:function(){if($this.prop("disabled")){return;}
$this.prop("disabled",true).addClass("disabled");},complete:function(){$this.prop("disabled",false).removeClass("disabled");}});return false;});$(document).on("submit","form[rel]",function(e){var $this=$(this),rel=$this.attr("rel"),href=$this.attr("action");if(typeof href==="undefined"||!href.length){e.preventDefault();return false;}
switch(rel){case"async":e.preventDefault();cg.ajax.request(href,{el:this,type:"POST",data:$this.serializeArray(),beforeSend:function(){if($this.prop("disabled")){return;}
$this.find("[type=submit]").prop("disabled",true).addClass("disabled");},complete:function(){$this.find("[type=submit]").prop("disabled",false).removeClass("disabled");}});return false;break;}});$(document).on("click","[data-confirm]",function(e){e.preventDefault();var that=$(this),href=that.attr("href"),message=that.data("confirm");if(!href.length){return false;}
if(!message.length){window.location.href=href;return;}
return cg.ui.confirm(message,function(){window.location.href=href;});});$(document).on("click","[data-action]",function(e){e.preventDefault();var that=$(this),action=that.data("action")||-1,target=that.data("target")||undefined,name=that.data("name")||"this",endpoint=that.data("endpoint")||that.attr("href")||undefined;if(action<=0){console.log("error action");return false;}
if(typeof target==="undefined"||!target.length||typeof gamelang[target]==="undefined"){return false;}
if(typeof endpoint==="undefined"||!endpoint.length){console.log("error endpoint");return false;}
var message=cg.i18n[target][action]||undefined;if(typeof message==="undefined"){message=cg.i18n[action]||undefined;if(typeof message==="undefined"){message="Are you sure you to "+action+" %s?";}}
var row=that.closest("tr");if(row.length){row.siblings("tr").addClass("op-2");}
if(typeof message!=="undefined"&&message.length){cg.ui.confirm(message.replace(/%s/g,name),function(){window.location.href=endpoint;},function(){if(row.length){row.siblings("tr").removeClass("op-2");}});return;}
window.location.href=endpoint;return;});});})(window.jQuery||window.Zepto,window,document);
